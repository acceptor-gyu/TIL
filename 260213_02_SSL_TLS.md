# SSL, TLS

## κ°μ”
SSL(Secure Sockets Layer)κ³Ό TLS(Transport Layer Security)λ” μΈν„°λ„· ν†µμ‹ μ—μ„ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μ•μ „ν•κ² μ „μ†΅ν•κΈ° μ„ν• μ•”νΈν™” ν”„λ΅ν† μ½μ…λ‹λ‹¤. HTTPS, FTPS, SMTPS λ“± λ‹¤μ–‘ν• ν”„λ΅ν† μ½μ—μ„ λ³΄μ• κ³„μΈµμΌλ΅ ν™μ©λ©λ‹λ‹¤.

## μƒμ„Έ λ‚΄μ©

### SSLκ³Ό TLSμ μ—­μ‚¬

#### SSL (Secure Sockets Layer)
- **SSL 1.0**: λ„·μ¤μΌ€μ΄ν”„κ°€ κ°λ°ν–μΌλ‚ κ³µκ°λμ§€ μ•μ (λ³΄μ• μ·¨μ•½μ )
- **SSL 2.0** (1995): μµμ΄ κ³µκ° λ²„μ „, μ‹¬κ°ν• λ³΄μ• κ²°ν•¨μΌλ΅ ν„μ¬ μ‚¬μ© κΈμ§€
- **SSL 3.0** (1996): SSL 2.0μ λ¬Έμ  κ°μ„ , ν•μ§€λ§ POODLE κ³µκ²©μ— μ·¨μ•½
- **ν„μ¬ μƒνƒ**: λ¨λ“  SSL λ²„μ „μ€ λ³΄μ•μƒ μ·¨μ•½ν•μ—¬ **μ‚¬μ© κΈμ§€** (RFC 7568)

#### TLS (Transport Layer Security)
- **TLS 1.0** (1999): SSL 3.0 κΈ°λ°μΌλ΅ IETFκ°€ ν‘μ¤€ν™” (RFC 2246)
- **TLS 1.1** (2006): CBC κ³µκ²© λ°©μ–΄ κ°μ„  (RFC 4346)
- **TLS 1.2** (2008): SHA-256 ν•΄μ‹, AEAD μ•”νΈν™” μ§€μ› (RFC 5246)
- **TLS 1.3** (2018): μµμ‹  λ²„μ „, ν•Έλ“μ…°μ΄ν¬ μµμ ν™” λ° λ³΄μ• κ°•ν™” (RFC 8446)
  - 1-RTT ν•Έλ“μ…°μ΄ν¬λ΅ μ„±λ¥ ν–¥μƒ
  - μ·¨μ•½ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦ μ κ±° (RSA ν‚¤ κµν™, CBC λ¨λ“ λ“±)
  - Forward Secrecy ν•„μ

> π’΅ **μ©μ–΄ νΌμ©**: μ‹¤λ¬΄μ—μ„λ” "SSL"μ΄λΌλ” μ©μ–΄λ¥Ό μ—¬μ „ν μ‚¬μ©ν•μ§€λ§, μ‹¤μ λ΅λ” TLSλ¥Ό μλ―Έν•©λ‹λ‹¤. "SSL/TLS" λλ” "TLS"λ΅ ν‘ν„ν•λ” κ²ƒμ΄ μ •ν™•ν•©λ‹λ‹¤.

### TLSμ λ©μ 

TLSλ” λ„¤νΈμ›ν¬ ν†µμ‹ μ—μ„ μ„Έ κ°€μ§€ ν•µμ‹¬ λ³΄μ• λ©ν‘λ¥Ό λ‹¬μ„±ν•©λ‹λ‹¤:

1. **κΈ°λ°€μ„± (Confidentiality)**
   - λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μ 3μκ°€ λ‚΄μ©μ„ μ½μ„ μ μ—†λ„λ΅ ν•¨
   - λ€μΉ­ν‚¤ μ•”νΈν™” μ‚¬μ© (AES-GCM, ChaCha20-Poly1305)

2. **λ¬΄κ²°μ„± (Integrity)**
   - μ „μ†΅ μ¤‘ λ°μ΄ν„°κ°€ λ³€μ΅°λμ§€ μ•μ•μμ„ λ³΄μ¥
   - MAC (Message Authentication Code) λλ” AEAD μ‚¬μ©

3. **μΈμ¦ (Authentication)**
   - μ„λ²„(λλ” ν΄λΌμ΄μ–ΈνΈ)μ μ‹ μ›μ„ κ²€μ¦
   - X.509 μΈμ¦μ„μ™€ κ³µκ°ν‚¤ μ•”νΈν™” μ‚¬μ©

### TLS ν•Έλ“μ…°μ΄ν¬ κ³Όμ •

#### TLS 1.2 ν•Έλ“μ…°μ΄ν¬ (2-RTT)

```
Client                                          Server

1. ClientHello           β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
   (μ§€μ› μ•”νΈν™” λ°©μ‹, TLS λ²„μ „, λλ¤ κ°’)

2.                       <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€   ServerHello
                                               (μ„ νƒλ μ•”νΈν™” λ°©μ‹, λλ¤ κ°’)
                                               Certificate (μ„λ²„ μΈμ¦μ„)
                                               ServerKeyExchange (ν‚¤ κµν™ μ •λ³΄)
                                               ServerHelloDone

3. ClientKeyExchange     β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
   (Pre-Master Secret μ•”νΈν™” μ „μ†΅)
   ChangeCipherSpec
   Finished

4.                       <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€   ChangeCipherSpec
                                               Finished

5. μ•”νΈν™”λ ν†µμ‹  μ‹μ‘   <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
```

**μ΄ 2-RTT (Round Trip Time)** μ†μ”

#### TLS 1.3 ν•Έλ“μ…°μ΄ν¬ (1-RTT)

```
Client                                          Server

1. ClientHello           β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
   (μ§€μ› μ•”νΈν™” λ°©μ‹, KeyShare)

2.                       <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€   ServerHello
                                               (μ„ νƒλ μ•”νΈν™” λ°©μ‹, KeyShare)
                                               {EncryptedExtensions}
                                               {Certificate}
                                               {CertificateVerify}
                                               {Finished}

3. {Finished}            β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>

4. μ•”νΈν™”λ ν†µμ‹  μ‹μ‘   <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
```

**μ΄ 1-RTT** μ†μ” (TLS 1.2 λ€λΉ„ 50% λΉ λ¦„)

**TLS 1.3μ 0-RTT λ¨λ“**:
- μ΄μ „ μ—°κ²° μ •λ³΄λ¥Ό μ¬μ‚¬μ©ν•μ—¬ μ²« μ”μ²­κ³Ό ν•¨κ» λ°μ΄ν„° μ „μ†΅ κ°€λ¥
- μ΄κ³ μ† μ¬μ—°κ²°, ν•μ§€λ§ Replay Attack μ„ν— μ΅΄μ¬

### μΈμ¦μ„ (Certificate)

#### X.509 μΈμ¦μ„ κµ¬μ΅°
```
Certificate:
  - Version: 3
  - Serial Number: μ μΌν• μ‹λ³„ λ²νΈ
  - Signature Algorithm: SHA-256 with RSA
  - Issuer: CN=DigiCert, O=DigiCert Inc, C=US (λ°κΈ‰μ)
  - Validity:
      Not Before: 2024-01-01 00:00:00
      Not After: 2025-01-01 23:59:59
  - Subject: CN=www.example.com, O=Example Inc, C=US (μ†μ μ)
  - Public Key: RSA 2048 bits / ECDSA P-256
  - Extensions:
      Subject Alternative Names: www.example.com, example.com
      Key Usage: Digital Signature, Key Encipherment
      Extended Key Usage: Server Authentication
  - Signature: (CAμ κ°μΈν‚¤λ΅ μ„λ…)
```

#### μΈμ¦μ„ μ²΄μΈ (Certificate Chain)
```
Root CA (μ‹ λΆ° λ£¨νΈ)
  β””β”€β”€ Intermediate CA
      β””β”€β”€ End-Entity Certificate (μ„λ²„ μΈμ¦μ„)
```

1. **Root CA**: λΈλΌμ°μ €/OSμ— μ‚¬μ „ μ„¤μΉλ μ‹ λΆ°ν•  μ μλ” μΈμ¦ κΈ°κ΄€
2. **Intermediate CA**: Root CAκ°€ μ„λ…ν• μ¤‘κ°„ μΈμ¦μ„
3. **End-Entity Certificate**: μ‹¤μ  μ„λ²„μ μΈμ¦μ„

**κ²€μ¦ κ³Όμ •**:
- μ„λ²„ μΈμ¦μ„ β†’ Intermediate CAλ΅ κ²€μ¦
- Intermediate CA β†’ Root CAλ΅ κ²€μ¦
- Root CAλ” μ‹ λΆ°ν•  μ μλ” μ €μ¥μ†μ— μμΌλ―€λ΅ κ²€μ¦ μ™„λ£

#### μΈμ¦μ„ λ°κΈ‰ κΈ°κ΄€ (CA)
- **μƒμ© CA**: DigiCert, Let's Encrypt, GlobalSign, Sectigo
- **Let's Encrypt**: λ¬΄λ£ μλ™ μΈμ¦μ„ λ°κΈ‰ (ACME ν”„λ΅ν† μ½)
- **μμ²΄ μ„λ… μΈμ¦μ„ (Self-Signed)**: κ°λ°/ν…μ¤νΈμ©, λΈλΌμ°μ € κ²½κ³  λ°μƒ

### μ•”νΈν™” μ•κ³ λ¦¬μ¦ λ™μ‘ μ›λ¦¬

TLSλ” μ—¬λ¬ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ κ³„μΈµμ μΌλ΅ μ΅°ν•©ν•μ—¬ μ•μ „ν• ν†µμ‹  μ±„λ„μ„ κµ¬μ¶•ν•©λ‹λ‹¤. κ° μ•κ³ λ¦¬μ¦μ μ—­ν• κ³Ό λ™μ‘ μ›λ¦¬, κ·Έλ¦¬κ³  μ™ κ·Έ μ•κ³ λ¦¬μ¦μ΄ μ„ νƒλμ—λ”μ§€ μ΄ν•΄ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

#### 1. ν‚¤ κµν™ μ•κ³ λ¦¬μ¦ (Key Exchange)

**λ©μ **: λ„μ²­ κ°€λ¥ν• κ³µκ° μ±„λ„μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ•μ „ν•κ² κ³µμ  λΉ„λ°€(μ„Έμ… ν‚¤)μ„ μƒμ„±

##### RSA ν‚¤ κµν™

**λ™μ‘ μ›λ¦¬**:
1. μ„λ²„κ°€ μΈμ¦μ„λ¥Ό ν†µν•΄ RSA κ³µκ°ν‚¤ μ „μ†΅
2. ν΄λΌμ΄μ–ΈνΈκ°€ 48λ°”μ΄νΈ Pre-Master Secret μƒμ„± (μ•”νΈν•™μ μΌλ΅ μ•μ „ν• λ‚μ)
3. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„ κ³µκ°ν‚¤λ΅ Pre-Master Secret μ•”νΈν™” β†’ μ„λ²„ μ „μ†΅
4. μ„λ²„κ°€ κ°μΈν‚¤λ΅ λ³µνΈν™”ν•μ—¬ Pre-Master Secret νλ“
5. μ–‘μΈ΅μ΄ Pre-Master Secretκ³Ό ν•Έλ“μ…°μ΄ν¬μ λλ¤ κ°’λ“¤μ„ μ΅°ν•©ν•μ—¬ Master Secret μƒμ„±
6. Master Secretμ—μ„ μ„Έμ… ν‚¤ νμƒ (HKDF μ‚¬μ©)

**λ³΄μ• λ¬Έμ **:
- **Forward Secrecy λ¶€μ¬**: μ„λ²„ κ°μΈν‚¤κ°€ μ μ¶λλ©΄, κ³Όκ±°μ— λ…Ήν™”λ λ¨λ“  μ„Έμ…μ Pre-Master Secretμ„ λ³µνΈν™” κ°€λ¥
  - κ³µκ²©μκ°€ μ•”νΈν™” νΈλν”½μ„ μ €μ¥ β†’ λ‚μ¤‘μ— κ°μΈν‚¤ νλ“ β†’ κ³Όκ±° ν†µμ‹  λ³µνΈν™”
  - μ΄λ¥Ό "μλ™μ  λ³µνΈν™” κ³µκ²©"μ΄λΌ ν•¨
- **ν‚¤ μ¬μ‚¬μ©**: λ¨λ“  μ„Έμ…μ΄ λ™μΌν• μ„λ²„ ν‚¤ μμ— μμ΅΄
- **TLS 1.3μ—μ„ μ™„μ „ μ κ±°λ¨**

##### DHE (Diffie-Hellman Ephemeral)

**μν•™μ  κΈ°λ°**: μ΄μ‚° λ΅κ·Έ λ¬Έμ  (Discrete Logarithm Problem)
- μ£Όμ–΄μ§„ g, p, g^a mod pμ—μ„ aλ¥Ό κµ¬ν•λ” κ²ƒμ΄ κ³„μ‚°μ μΌλ΅ μ–΄λ ¤μ›€

**λ™μ‘ κ³Όμ •**:
```
κ³µκ° νλΌλ―Έν„°: ν° μ†μ p, μƒμ„±μ› g

ν΄λΌμ΄μ–ΈνΈ:                      μ„λ²„:
1. λΉ„λ°€κ°’ a μ„ νƒ (λλ¤)          1. λΉ„λ°€κ°’ b μ„ νƒ (λλ¤)
2. A = g^a mod p κ³„μ‚°           2. B = g^b mod p κ³„μ‚°
3. A μ „μ†΅ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
4.              <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ B μ „μ†΅
5. κ³µμ  λΉ„λ°€ = B^a mod p        5. κ³µμ  λΉ„λ°€ = A^b mod p
   = g^(ab) mod p                  = g^(ab) mod p
```

**λ³΄μ• μ†μ„±**:
- **μ΄μ‚° λ΅κ·Έ λ¬Έμ **: κ³µκ²©μλ” g, p, A, Bλ¥Ό μ•μ•„λ„ aλ‚ bλ¥Ό ν¨μ¨μ μΌλ΅ κ³„μ‚°ν•  μ μ—†μ
- **Forward Secrecy**: a, bλ¥Ό λ§¤ μ„Έμ…λ§λ‹¤ μƒλ΅ μƒμ„±ν•κ³  μ„Έμ… μΆ…λ£ ν›„ νκΈ°
  - κ³Όκ±° μ„Έμ…μ a, bλ” λ³µκµ¬ λ¶κ°€λ¥ β†’ κ³Όκ±° ν†µμ‹  λ³΄νΈ

**λ‹¨μ **:
- ν° μ†μ μ—°μ‚° ν•„μ” (2048-bit μ΄μƒ)
- λ¨λ“λ¬ μ§€μ μ—°μ‚°μ κ³„μ‚° λΉ„μ©μ΄ λ†’μ
- ECDHEμ— λΉ„ν•΄ ν‚¤ ν¬κΈ°μ™€ μ„±λ¥ λ©΄μ—μ„ λΉ„ν¨μ¨μ 

##### ECDHE (Elliptic Curve Diffie-Hellman Ephemeral) β­

**μν•™μ  κΈ°λ°**: νƒ€μ› κ³΅μ„  μ΄μ‚° λ΅κ·Έ λ¬Έμ  (ECDLP)
- νƒ€μ› κ³΅μ„  λ°©μ •μ‹: yΒ² = xΒ³ + ax + b (mod p)
- κ³΅μ„  μ„μ μ λ“¤μ— λ€ν• λ§μ… μ—°μ‚° μ •μ
- μ£Όμ–΄μ§„ G, kGμ—μ„ kλ¥Ό κµ¬ν•λ” κ²ƒμ΄ κ³„μ‚°μ μΌλ΅ μ–΄λ ¤μ›€

**λ™μ‘ κ³Όμ •**:
```
κ³µκ° νλΌλ―Έν„°: νƒ€μ› κ³΅μ„  E, κΈ°μ¤€μ  G

ν΄λΌμ΄μ–ΈνΈ:                      μ„λ²„:
1. λΉ„λ°€ μ¤μΉΌλΌ d_c μ„ νƒ         1. λΉ„λ°€ μ¤μΉΌλΌ d_s μ„ νƒ
2. Q_c = d_c Γ— G κ³„μ‚°           2. Q_s = d_s Γ— G κ³„μ‚°
   (μ  Gλ¥Ό d_cλ² λ”ν•λ” μ¤μΉΌλΌ κ³±)
3. Q_c μ „μ†΅ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>
4.              <β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ Q_s μ „μ†΅
5. κ³µμ  λΉ„λ°€ = d_c Γ— Q_s        5. κ³µμ  λΉ„λ°€ = d_s Γ— Q_c
   = (d_c Γ— d_s) Γ— G               = (d_c Γ— d_s) Γ— G
```

**ν¨μ¨μ„±**:
- **ν‚¤ ν¬κΈ° λ€λΉ„ λ³΄μ• κ°•λ„**:
  - 256-bit ECDHE β‰ 3072-bit DHE (λ™μΌ λ³΄μ• μμ¤€)
  - 521-bit ECDHE β‰ 15360-bit RSA
- **κ³„μ‚° ν¨μ¨**: νƒ€μ› κ³΅μ„  μ—°μ‚°μ΄ λ¨λ“λ¬ μ§€μ μ—°μ‚°λ³΄λ‹¤ ν¨μ¨μ 
- **λ€μ—­ν­ μ μ•½**: μ‘μ€ ν‚¤ ν¬κΈ°λ΅ λ„¤νΈμ›ν¬ μ „μ†΅λ‰ κ°μ†

**μ£Όμ” κ³΅μ„ **:
- **P-256 (secp256r1)**: NIST ν‘μ¤€, FIPS μΉμΈ, κ°€μ¥ λ„λ¦¬ λ°°ν¬λ¨
- **P-384, P-521**: λ” λ†’μ€ λ³΄μ• μμ¤€ (μ¥κΈ° λΉ„λ°€ λ³΄νΈ)
- **X25519 (Curve25519)**:
  - λ½κ³ λ©”λ¦¬ κ³΅μ„  κΈ°λ°
  - νƒ€μ΄λ° κ³µκ²© μ €ν•­μ„±
  - κµ¬ν„ λ‹¨μμ„±κ³Ό μ†λ„ μµμ ν™”
  - TLS 1.3 κ¶μ¥ κ³΅μ„ 

**TLS 1.3 μµμ ν™”**:
- ClientHelloμ— KeyShare ν™•μ¥ ν¬ν•¨ (Q_c λ―Έλ¦¬ μ „μ†΅)
- μ„λ²„κ°€ κ³΅μ„  μ„ νƒ ν›„ μ¦‰μ‹ μ‘λ‹µ κ°€λ¥
- 1-RTT ν•Έλ“μ…°μ΄ν¬ λ‹¬μ„±

**Forward Secrecy κµ¬ν„**:
- λ§¤ μ—°κ²°λ§λ‹¤ μƒλ΅μ΄ d_c, d_s μƒμ„±
- ν•Έλ“μ…°μ΄ν¬ μ™„λ£ ν›„ μ¦‰μ‹ νκΈ°
- μ¥κΈ° ν‚¤(μΈμ¦μ„μ κ°μΈν‚¤) μ μ¶κ³Ό λ¬΄κ΄€ν•κ² μ„Έμ… λ³΄νΈ

#### 2. λ€μΉ­ν‚¤ μ•”νΈν™” (Symmetric Encryption)

**λ©μ **: ν‚¤ κµν™μΌλ΅ μƒμ„±λ μ„Έμ… ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ€λ‰μ μ• ν”λ¦¬μΌ€μ΄μ… λ°μ΄ν„°λ¥Ό ν¨μ¨μ μΌλ΅ μ•”νΈν™”

**λ€μΉ­ν‚¤ vs λΉ„λ€μΉ­ν‚¤**:
- λ€μΉ­ν‚¤: μ•”νΈν™”μ™€ λ³µνΈν™”μ— λ™μΌν• ν‚¤ μ‚¬μ©, λ§¤μ° λΉ λ¦„ (μμ² λ°° μ°¨μ΄)
- λΉ„λ€μΉ­ν‚¤: ν‚¤ μ μ‚¬μ©, λλ¦¬μ§€λ§ ν‚¤ λ°°ν¬ λ¬Έμ  ν•΄κ²°
- TLS μ „λµ: λΉ„λ€μΉ­ν‚¤λ΅ μ„Έμ… ν‚¤ κµν™ β†’ λ€μΉ­ν‚¤λ΅ λ°μ΄ν„° μ•”νΈν™”

##### AES (Advanced Encryption Standard)

**κ°μ”**:
- λΈ”λ΅ μ•”νΈ (128-bit λΈ”λ΅ λ‹¨μ„ μ²λ¦¬)
- ν‚¤ ν¬κΈ°: 128-bit, 192-bit, 256-bit
- SPN κµ¬μ΅° (Substitution-Permutation Network)
- λΌμ΄λ“ μ: 10, 12, 14 (ν‚¤ ν¬κΈ°μ— λ”°λΌ)

**λ™μ‘**:
1. **SubBytes**: λΉ„μ„ ν• μΉν™ (S-Box ν…μ΄λΈ” λ£©μ—…)
2. **ShiftRows**: λ°”μ΄νΈ μν™ μ΄λ™
3. **MixColumns**: μ—΄ λ‹¨μ„ μ„ ν• λ³€ν™ (GF(2^8) μƒμ ν–‰λ ¬ κ³±)
4. **AddRoundKey**: λΌμ΄λ“ ν‚¤μ™€ XOR

**μ΄μ© λ¨λ“**:

**CBC (Cipher Block Chaining)** - TLS 1.2μ—μ„ μ‚¬μ©, TLS 1.3μ—μ„ μ κ±°
```
μ•”νΈν™”: C[i] = E(P[i] β• C[i-1], K), C[0] = IV
λ³µνΈν™”: P[i] = D(C[i], K) β• C[i-1]

λ¬Έμ μ :
- μμ°¨ μμ΅΄μ„±μΌλ΅ λ³‘λ ¬ν™” λ¶κ°€ (μ•”νΈν™” μ‹)
- Padding Oracle κ³µκ²© μ·¨μ•½:
  - ν¨λ”© μ¤λ¥ λ©”μ‹μ§€λ΅ ν‰λ¬Έ λ³µκµ¬ κ°€λ¥
  - POODLE, Lucky13 λ“±μ κ³µκ²©
- μ•”νΈν™”μ™€ μΈμ¦(HMAC)μ„ λ³„λ„ μν–‰ ν•„μ”
```

**GCM (Galois/Counter Mode)** - TLS 1.2, 1.3 ν‘μ¤€
```
μ•”νΈν™”: C[i] = P[i] β• E(Counter[i], K)
μΈμ¦: AuthTag = GHASH(AAD || C, H)

μ—¬κΈ°μ„:
- Counter: Nonce || μΉ΄μ΄ν„° (96-bit + 32-bit)
- GHASH: GF(2^128) μƒμ λ‹¤ν•­μ‹ ν•΄μ‹
- AAD: Additional Authenticated Data
```

**AES-GCM μ¥μ **:
- **AEAD**: μ•”νΈν™”μ™€ μΈμ¦μ„ λ‹¨μΌ primitiveλ΅ μ κ³µ
- **λ³‘λ ¬ν™”**: κ° λΈ”λ΅μ΄ λ…λ¦½μ μΌλ΅ μ²λ¦¬ κ°€λ¥
- **ν•λ“μ›¨μ–΄ κ°€μ†**: AES-NI λ…λ Ήμ–΄ μ§€μ› (Intel, AMD, ARM)
  - AESENC, AESENCLAST, PCLMULQDQ λ…λ Ήμ–΄λ΅ 10+ GB/s μ²λ¦¬ κ°€λ¥
- **AAD μ§€μ›**: TLS ν—¤λ” λ“±μ„ μ•”νΈν™” μ—†μ΄ μΈμ¦λ§ κ°€λ¥

**λ³΄μ• κ³ λ ¤μ‚¬ν•­**:
- **Nonce μ¬μ‚¬μ© κΈμ§€**: κ°™μ€ ν‚¤μ™€ Nonce μ΅°ν•©μΌλ΅ λ‘ λ©”μ‹μ§€ μ•”νΈν™” μ‹ μΉλ…μ 
  - Nonce μ¶©λ μ‹ ν‚¤μ¤νΈλ¦Ό μ¬μ‚¬μ© β†’ XORλ΅ ν‰λ¬Έ λ³µκµ¬ κ°€λ¥
- **AuthTag κΈΈμ΄**: 128-bit κ¶μ¥ (TLSλ” 128-bit μ‚¬μ©)

##### ChaCha20-Poly1305

**κ°μ”**:
- μ¤νΈλ¦Ό μ•”νΈ (ChaCha20) + MAC (Poly1305) μ΅°ν•©
- Daniel J. Bernstein μ„¤κ³„, Googleμ΄ TLSμ— λ„μ…
- ARX κµ¬μ΅° (Add-Rotate-XOR), ν•λ“μ›¨μ–΄ μΉν™”μ  μ„¤κ³„

**ChaCha20 (μ•”νΈν™”)**:
```
μ…λ ¥: 256-bit ν‚¤, 96-bit Nonce, 32-bit Counter
μ¶λ ¥: 512-bit ν‚¤μ¤νΈλ¦Ό λΈ”λ΅

λ™μ‘:
1. 4x4 μƒνƒ ν–‰λ ¬ μ΄κΈ°ν™” (μƒμ, ν‚¤, Nonce, Counter)
2. 20 λΌμ΄λ“ (10λ²μ λ”λΈ” λΌμ΄λ“)
   - κ° λΌμ΄λ“: 4κ°μ μΏΌν„° λΌμ΄λ“ (ARX μ—°μ‚°)
3. μ΄κΈ° μƒνƒμ™€ λ”ν•κΈ°
4. ν‚¤μ¤νΈλ¦Ό β• ν‰λ¬Έ = μ•”νΈλ¬Έ
```

**Poly1305 (μΈμ¦)**:
```
μΌνμ© ν‚¤ r, s μ‚¬μ© (ChaCha20μ μ²« λΈ”λ΅μ—μ„ νμƒ)
MAC = ((c[1]r^n + c[2]r^(n-1) + ... + c[n]r) mod (2^130-5)) + s

μ—¬κΈ°μ„ c[i]λ” λ©”μ‹μ§€ λΈ”λ΅, μ—°μ‚°μ€ μ ν•μ²΄ μƒμ—μ„ μν–‰
```

**μ¥μ **:
- **μ†ν”„νΈμ›¨μ–΄ μµμ ν™”**: AES-NI μ—†λ” ν™κ²½μ—μ„ AESλ³΄λ‹¤ 2-3λ°° λΉ λ¦„
  - ARM, μ €μ „λ ¥ CPUμ—μ„ νΉν μ λ¦¬
- **νƒ€μ΄λ° κ³µκ²© μ €ν•­**: λ°μ΄ν„° μμ΅΄μ  λ¶„κΈ°/ν…μ΄λΈ” λ£©μ—… μ—†μ
  - μΊμ‹ νƒ€μ΄λ° κ³µκ²© μ›μ² μ°¨λ‹¨
- **κµ¬ν„ λ‹¨μμ„±**: S-Box λ¶ν•„μ”, μƒμ μ‹κ°„ κµ¬ν„ μ©μ΄
- **λ³‘λ ¬ν™”**: μ—¬λ¬ λΈ”λ΅ λ™μ‹ μ²λ¦¬ κ°€λ¥

**TLS 1.3 Cipher Suite**:
- TLS_CHACHA20_POLY1305_SHA256 (ν•„μ μ§€μ›)

**μ„ νƒ κΈ°μ¤€**:

| ν™κ²½ | κ¶μ¥ | μ΄μ  |
|------|------|------|
| x86-64 μ„λ²„ (AES-NI) | AES-GCM | ν•λ“μ›¨μ–΄ κ°€μ†μΌλ΅ 10+ GB/s |
| ARM λ¨λ°”μΌ/μ„λ²„ | ChaCha20 | μ†ν”„νΈμ›¨μ–΄ κµ¬ν„ μ°μ |
| IoT, μ„λ² λ””λ“ | ChaCha20 | λ©”λ¨λ¦¬ ν¨μ¨, λ‹¨μ κµ¬ν„ |
| μΌλ° ν΄λΌμ΄μ–ΈνΈ | ν‘μƒ | CPU νΉμ„±μ— λ”°λΌ μ„ νƒ |

**μ„±λ¥ λΉ„κµ** (μ†ν”„νΈμ›¨μ–΄ κµ¬ν„, CPU μ‚¬μ΄ν΄/λ°”μ΄νΈ):
- AES-GCM (AES-NI): ~1-2 cycles/byte
- AES-GCM (sw): ~10-15 cycles/byte
- ChaCha20-Poly1305: ~5-7 cycles/byte

#### 3. ν•΄μ‹ ν•¨μ (Hash Function)

**λ©μ **: λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ¦, λ””μ§€ν„Έ μ„λ…, ν‚¤ νμƒ

**μ•”νΈν•™μ  ν•΄μ‹ ν•¨μ μ”κµ¬μ‚¬ν•­**:
1. **μΌλ°©ν–¥μ„± (Pre-image resistance)**: h = H(m)μ—μ„ m λ³µκµ¬ κ³„μ‚°μ μΌλ΅ λ¶κ°€λ¥
2. **μ•½ν• μ¶©λ μ €ν•­μ„± (Second pre-image resistance)**: m1μ΄ μ£Όμ–΄μ΅μ„ λ• H(m1) = H(m2)μΈ m2 μ°ΎκΈ° μ–΄λ ¤μ›€
3. **κ°•ν• μ¶©λ μ €ν•­μ„± (Collision resistance)**: H(m1) = H(m2)μΈ μ„μμ m1, m2 μ μ°ΎκΈ° μ–΄λ ¤μ›€

##### SHA-256 (Secure Hash Algorithm 256)

**κµ¬μ΅°**: Merkle-DamgΓ¥rd κµ¬μ΅° κΈ°λ°

**λ™μ‘ κ³Όμ •**:
1. **ν¨λ”©**: λ©”μ‹μ§€λ¥Ό 512-bit λΈ”λ΅μ λ°°μλ΅ λ§λ“¦
   - λ©”μ‹μ§€ || 1 || 0* || κΈΈμ΄(64-bit)
2. **μ΄κΈ°ν™”**: 8κ°μ 32-bit ν•΄μ‹κ°’ (H0~H7, μ†μμ μ κ³±κ·Ό)
3. **μ••μ¶• ν•¨μ**: κ° 512-bit λΈ”λ΅μ— λ€ν•΄:
   - 64κ°μ 32-bit λ‹¨μ–΄λ΅ ν™•μ¥ (λ©”μ‹μ§€ μ¤μΌ€μ¤„)
   - 64λΌμ΄λ“ μ²λ¦¬ (λ…Όλ¦¬ ν•¨μ, νμ „, λ¨λ“λ¬ λ§μ…)
   - 8κ°μ μ‘μ—… λ³€μ μ—…λ°μ΄νΈ
4. **μ¶λ ¥**: 256-bit λ‹¤μ΄μ μ¤νΈ

**λ³΄μ• νΉμ„±**:
- **λμ‚¬νƒ ν¨κ³Ό (Avalanche effect)**: μ…λ ¥ 1-bit λ³€κ²½ μ‹ μ¶λ ¥ ν‰κ·  50% λ³€κ²½
- **μ¶©λ μ €ν•­μ„±**: 2^128 μ—°μ‚° ν•„μ” (μƒμΌ κ³µκ²©)
- **μ—­μƒ μ €ν•­μ„±**: 2^256 μ—°μ‚° ν•„μ”

**TLSμ—μ„μ μ‚¬μ©**:
1. **Finished λ©”μ‹μ§€**: `Verify_data = PRF(master_secret, "finished", Hash(handshake_messages))`
   - ν•Έλ“μ…°μ΄ν¬ λ©”μ‹μ§€ λ¬΄κ²°μ„± κ²€μ¦
2. **HKDF (HMAC-based Key Derivation Function)**:
   - Master Secret β†’ μ—¬λ¬ μ„Έμ… ν‚¤ νμƒ
   - `HKDF-Expand(PRK, info, L)`
3. **μΈμ¦μ„ μ„λ…**: CAκ°€ μΈμ¦μ„ λ‚΄μ©μ SHA-256 ν•΄μ‹μ— λ””μ§€ν„Έ μ„λ…

##### HMAC (Hash-based Message Authentication Code)

**κµ¬μ΅°**:
```
HMAC(K, M) = H((K β• opad) || H((K β• ipad) || M))

μ—¬κΈ°μ„:
- K: λΉ„λ°€ ν‚¤ (λΈ”λ΅ ν¬κΈ°λ΅ ν¨λ”©)
- ipad = 0x36 λ°λ³µ (λ‚΄λ¶€ ν¨λ”©)
- opad = 0x5C λ°λ³µ (μ™Έλ¶€ ν¨λ”©)
- H: ν•΄μ‹ ν•¨μ (SHA-256)
```

**λ³΄μ• κ·Όκ±°**:
- λ‹¨μ H(K || M)μ€ κΈΈμ΄ ν™•μ¥ κ³µκ²© (Length Extension Attack) μ·¨μ•½
- μ΄μ¤‘ ν•΄μ‹± κµ¬μ΅°λ΅ κ³µκ²© λ°©μ–΄
- λΉ„λ°€ ν‚¤ μ—†μ΄λ” μ ν¨ν• MAC μƒμ„± λ¶κ°€λ¥

**TLS 1.2μ—μ„μ μ‚¬μ©** (Encrypt-then-MAC):
```
1. ν‰λ¬Έ μ•”νΈν™”: C = Enc(K_enc, P)
2. MAC κ³„μ‚°: MAC = HMAC(K_mac, seq || type || version || length || C)
3. μ „μ†΅: C || MAC

μμ‹ :
1. MAC κ²€μ¦ (νƒ€μ΄λ° κ³µκ²© κ³ λ ¤ν• μƒμ μ‹κ°„ λΉ„κµ)
2. MAC μΌμΉ μ‹ λ³µνΈν™”, λ¶μΌμΉ μ‹ μ—°κ²° μΆ…λ£ (HMAC μ¤λ¥)
```

**TLS 1.3 λ³€κ²½μ‚¬ν•­**:
- AEAD μ‚¬μ©μΌλ΅ Encrypt-then-MAC λ¶ν•„μ”
- HKDFμ—μ„λ§ HMAC μ‚¬μ© (ν‚¤ νμƒ)
  - `HKDF-Extract(salt, IKM) = HMAC(salt, IKM)`
  - `HKDF-Expand(PRK, info, L)`

#### 4. λ””μ§€ν„Έ μ„λ… (Digital Signature)

**λ©μ **: μ„λ²„/ν΄λΌμ΄μ–ΈνΈ μΈμ¦, λ©”μ‹μ§€ λ¬΄κ²°μ„±, λ¶€μΈ λ°©μ§€ (Non-repudiation)

**κ³µκ°ν‚¤ μ„λ… κµ¬μ΅°**:
- μ„λ… μƒμ„±: `Οƒ = Sign(SK, m)`
- μ„λ… κ²€μ¦: `Verify(PK, m, Οƒ) β†’ {valid, invalid}`
- κ°μΈν‚¤(SK) μ†μ μλ§ μ ν¨ν• μ„λ… μƒμ„± κ°€λ¥
- κ³µκ°ν‚¤(PK)λ΅ λ„κµ¬λ‚ κ²€μ¦ κ°€λ¥

##### RSA μ„λ…

**RSASSA-PSS (TLS 1.3 ν•„μ)**:
```
μ„λ… μƒμ„±:
1. h = Hash(M)
2. ν¨λ”©: MGF1μ„ μ‚¬μ©ν• PSS ν¨λ”© μ μ©
3. Οƒ = (padded_h)^d mod n  (d: κ°μΈμ§€μ, n: λ¨λ“λ¬μ¤)

μ„λ… κ²€μ¦:
1. h' = Hash(M)
2. padded_h = Οƒ^e mod n  (e: κ³µκ°μ§€μ, μΌλ°μ μΌλ΅ 65537)
3. PSS ν¨λ”© κ²€μ¦ λ° h' λΉ„κµ
```

**RSASSA-PKCS1-v1_5 (TLS 1.2, ν•μ„ νΈν™)**:
- κ²°μ •μ  ν¨λ”© λ°©μ‹ (λ³΄μ•μ„± λ‚®μ)
- Bleichenbacherμ μ„λ… μ„μ΅° κ³µκ²© κ°€λ¥ (νΉμ • μ΅°κ±΄)
- TLS 1.3μ—μ„ μ κ±°λ¨

**TLS ν•Έλ“μ…°μ΄ν¬μ—μ„μ μ‚¬μ©**:
```
CertificateVerify λ©”μ‹μ§€:
- μ„λ… λ€μƒ: Hash(ClientHello || ... || ServerCertificate)
- μ„λ²„κ°€ κ°μΈν‚¤λ΅ μ„λ…
- ν΄λΌμ΄μ–ΈνΈκ°€ μΈμ¦μ„μ κ³µκ°ν‚¤λ΅ κ²€μ¦
β†’ μ„λ²„κ°€ μΈμ¦μ„μ κ°μΈν‚¤λ¥Ό μ†μ ν–μμ„ μ¦λ…
```

**ν‚¤ ν¬κΈ° κ¶μ¥**:
- 2048-bit: ν„μ¬ μµμ† κΈ°μ¤€ (~112-bit λ³΄μ• κ°•λ„)
- 3072-bit: 2030λ…„κΉμ§€ κ¶μ¥ (~128-bit λ³΄μ• κ°•λ„)
- 4096-bit: μ¥κΈ° λΉ„λ°€ λ³΄νΈ (~140-bit λ³΄μ• κ°•λ„)

##### ECDSA (Elliptic Curve Digital Signature Algorithm)

**μ„λ… μƒμ„±**:
```
μ…λ ¥: λ©”μ‹μ§€ M, κ°μΈν‚¤ d, κ³΅μ„  νλΌλ―Έν„° (E, G, n)

1. h = Hash(M)
2. k β† μ•”νΈν•™μ μΌλ΅ μ•μ „ν• λ‚μ [1, n-1]  β οΈ μ¤‘μ”!
3. (x, y) = k Γ— G
4. r = x mod n
5. s = k^(-1) Γ— (h + d Γ— r) mod n
6. μ„λ…: (r, s)
```

**μ„λ… κ²€μ¦**:
```
μ…λ ¥: λ©”μ‹μ§€ M, μ„λ… (r, s), κ³µκ°ν‚¤ Q

1. h = Hash(M)
2. w = s^(-1) mod n
3. u1 = h Γ— w mod n
4. u2 = r Γ— w mod n
5. (x, y) = u1 Γ— G + u2 Γ— Q
6. κ²€μ¦: r == x mod n
```

**λ³΄μ• μ·¨μ•½μ  - Nonce μ¬μ‚¬μ©**:
```
λ‘ μ„λ… (r, s1), (r, s2)μ—μ„ κ°™μ€ k μ‚¬μ© μ‹:
s1 - s2 = k^(-1)(h1 - h2) mod n
β†’ k κ³„μ‚° κ°€λ¥
β†’ d = r^(-1)(ks - h) mod nλ΅ κ°μΈν‚¤ λ³µκµ¬

μ‹¤μ  μ‚¬λ΅€:
- Sony PS3 (2010): κ³ μ •λ k μ‚¬μ© β†’ κ°μΈν‚¤ μ μ¶
- Android SecureRandom (2013): λ¶μ¶©λ¶„ν• λ‚μ β†’ Bitcoin μ§€κ°‘ κ³µκ²©
```

**λ€μ‘μ±…**:
- **RFC 6979**: κ²°μ •μ  k μƒμ„± `k = HMAC_DRBG(d, h)`
  - μ•”νΈν•™μ  μ•μ „μ„± μ μ§€ν•λ©΄μ„ λ‚μ μƒμ„± μ‹¤ν¨ λ°©μ§€
- **νƒ€μ΄λ° κ³µκ²© λ°©μ§€**: μƒμ μ‹κ°„ μ¤μΉΌλΌ κ³± κµ¬ν„

**μ£Όμ” κ³΅μ„ **:
- **P-256 (secp256r1)**: ~128-bit λ³΄μ• κ°•λ„, NIST/FIPS μΉμΈ
- **P-384 (secp384r1)**: ~192-bit λ³΄μ• κ°•λ„

##### EdDSA (Edwards-curve Digital Signature Algorithm)

**Ed25519 μ„λ… μƒμ„±**:
```
μ…λ ¥: λ©”μ‹μ§€ M, κ°μΈν‚¤ seed (32 bytes)

1. (a, prefix) = SHA-512(seed)
   a: μ¤μΉΌλΌ (ν•μ„ 256-bit, clamping μ μ©)
   prefix: Nonce νμƒμ©
2. κ³µκ°ν‚¤: A = a Γ— G
3. r = SHA-512(prefix || M) mod L  (κ²°μ •μ !)
4. R = r Γ— G
5. h = SHA-512(R || A || M) mod L
6. s = (r + h Γ— a) mod L
7. μ„λ…: (R, s)  (64 bytes)
```

**μ£Όμ” νΉμ§•**:
- **κ²°μ •μ  Nonce**: ECDSAμ k μ¬μ‚¬μ© λ¬Έμ  μ›μ² μ°¨λ‹¨
- **μ¶©λ μ €ν•­**: Edwards κ³΅μ„  νΉμ„±μΌλ΅ μμ™Έ μΌ€μ΄μ¤ μ—†μ
- **νƒ€μ΄λ° κ³µκ²© μ €ν•­**: μ„¤κ³„λ¶€ν„° μƒμ μ‹κ°„ κµ¬ν„
- **λΉ λ¥Έ μ†λ„**: μµμ ν™”λ κ³΅μ„  μ—°μ‚°
- **μ‘μ€ ν¬κΈ°**: κ³µκ°ν‚¤ 32 bytes, μ„λ… 64 bytes

**ECDSA vs EdDSA**:

| νΉμ„± | ECDSA (P-256) | EdDSA (Ed25519) |
|------|---------------|-----------------|
| Nonce | μ•”νΈν•™μ  λ‚μ ν•„μ” | κ²°μ •μ  μƒμ„± |
| κµ¬ν„ μ•μ „μ„± | μ£Όμ ν•„μ” (k κ΄€λ¦¬) | μ„¤κ³„λ¶€ν„° μ•μ „ |
| μ†λ„ | μ¤‘κ°„ | λΉ λ¦„ |
| ν‘μ¤€ν™” | μ¤λλ¨ (κ΄‘λ²”μ„) | λΉ„κµμ  μµκ·Ό |
| TLS μ§€μ› | 1.2, 1.3 | 1.3 (μ„ νƒ) |

**TLS 1.3 μ„λ… μ•κ³ λ¦¬μ¦ λ©λ΅**:
```
SignatureScheme {
  rsa_pkcs1_sha256(0x0401),    // ν•μ„ νΈν™ (1.2)
  rsa_pss_rsae_sha256(0x0804), // κ¶μ¥
  ecdsa_secp256r1_sha256(0x0403),
  ecdsa_secp384r1_sha384(0x0503),
  ed25519(0x0807),
  ed448(0x0808)
}

#### 5. AEAD (Authenticated Encryption with Associated Data)

**κ°λ…**: λ‹¨μΌ primitiveλ΅ κΈ°λ°€μ„±κ³Ό λ¬΄κ²°μ„±μ„ λ™μ‹μ— μ κ³µ

**Encrypt-then-MACμ λ¬Έμ **:
```
TLS 1.2 (AES-CBC + HMAC):
1. C = Enc(K_enc, P)
2. T = HMAC(K_mac, C)
3. μ „μ†΅: C || T

λ¬Έμ μ :
- λ‘ λ…λ¦½μ μΈ primitive ν•„μ” (λ³µμ΅μ„±)
- Padding Oracle κ³µκ²© (Lucky13, POODLE):
  - ν¨λ”© κ²€μ¦ μ¤λ¥ vs MAC κ²€μ¦ μ¤λ¥ νƒ€μ΄λ° μ°¨μ΄
  - μ¤λ¥ λ©”μ‹μ§€λ΅ ν‰λ¬Έ λΉ„νΈ λ‹¨μ„ λ³µκµ¬ κ°€λ¥
- μμ°¨μ  μ²λ¦¬ ν•„μ”
```

**AEAD μΈν„°νμ΄μ¤**:
```
AEAD-Encrypt(K, N, A, P) β†’ (C, T)
AEAD-Decrypt(K, N, A, C, T) β†’ P or β¥

μ…λ ¥:
- K: λΉ„λ°€ ν‚¤
- N: Nonce (Number used Once, μ¬μ‚¬μ© κΈμ§€!)
- A: Additional Authenticated Data (μ•”νΈν™” X, μΈμ¦ O)
- P: Plaintext

μ¶λ ¥:
- C: Ciphertext
- T: Authentication Tag
```

**TLS 1.3 Record ν”„λ΅ν† μ½**:
```
TLSCiphertext κµ¬μ΅°:
- ContentType (1 byte): μ•”νΈν™” μ „ λ μ½”λ“ νƒ€μ…
- ProtocolVersion (2 bytes): legacy_record_version = 0x0303
- Length (2 bytes): encrypted_record κΈΈμ΄
- encrypted_record: AEAD(K, N, AAD, P || ContentType || padding)

AAD = ContentType || ProtocolVersion || Length
Nonce = per_connection_IV β• sequence_number

λ³µνΈν™”:
1. AEAD-Decrypt μν–‰
2. μ‹¤ν¨ μ‹ bad_record_mac alertλ΅ μ—°κ²° μΆ…λ£
3. μ„±κ³µ μ‹ ν¨λ”© μ κ±° λ° ContentType ν™•μΈ
```

**Nonce κ΄€λ¦¬**:
```
TLS 1.3:
- μ—°κ²° μλ¦½ μ‹ client_write_iv, server_write_iv νμƒ (HKDF)
- Nonce = IV β• sequence_number (64-bit)
- sequence_numberλ” κ° λ μ½”λ“λ§λ‹¤ μ¦κ°€ (0λ¶€ν„° μ‹μ‘)
- μ¬μ‚¬μ© λ°©μ§€: 2^64 λ μ½”λ“ μ „μ†΅ ν›„ ν‚¤ μ¬ν‘μƒ (μ‹¤μ λ΅λ” ν›¨μ”¬ μ΄μ „)

β οΈ Nonce μ¬μ‚¬μ©μ μΉλ…μ„±:
- AES-GCM: λ™μΌ (K, N) μ¬μ‚¬μ© μ‹ μΈμ¦ ν‚¤ H λ³µκµ¬ κ°€λ¥
  β†’ μ„μ ν‰λ¬Έ μ•”νΈν™” λ° μ„μ΅° κ°€λ¥
- ChaCha20: ν‚¤μ¤νΈλ¦Ό μ¬μ‚¬μ© β†’ XORλ΅ ν‰λ¬Έ κ°„ κ΄€κ³„ λ…Έμ¶
```

**λ³΄μ• μ†μ„±**:
- **IND-CPA**: μ„ νƒ ν‰λ¬Έ κ³µκ²©μ— μ•μ „ (Nonce κ³ μ μ„± κ°€μ •)
- **INT-CTXT**: Ciphertext λ¬΄κ²°μ„± (νƒκ·Έ μ„μ΅° λ¶κ°€λ¥)
- **ν¨λ”© μ¤λΌν΄ λ°©μ§€**: λ³µνΈν™” μ „ μΈμ¦ κ²€μ¦ (μ‹¤ν¨ μ‹ λ‹¨μΌ μ¤λ¥)

**μ¥μ **:
- λ‹¨μμ„±: λ‹¨μΌ μ•κ³ λ¦¬μ¦μΌλ΅ κΈ°λ°€μ„± + λ¬΄κ²°μ„±
- μ„±λ¥: λ³„λ„ MAC κ³„μ‚° λ¶ν•„μ”, λ³‘λ ¬ν™” κ°€λ¥
- λ³΄μ•: νƒ€μ΄λ° κ³µκ²© ν‘λ©΄ κ°μ†

#### TLS 1.2 vs TLS 1.3 μ•”νΈν™” μ•κ³ λ¦¬μ¦ λΉ„κµ

**μ κ±°λ μ•κ³ λ¦¬μ¦** (TLS 1.3):

| μ•κ³ λ¦¬μ¦ | μ κ±° μ΄μ  |
|---------|----------|
| RSA ν‚¤ κµν™ | Forward Secrecy λ¶€μ¬, μλ™μ  λ³µνΈν™” κ³µκ²© |
| μ •μ  DH | Forward Secrecy λ¶€μ¬ |
| AES-CBC | Padding Oracle κ³µκ²© (Lucky13, POODLE) |
| RC4 | ν†µκ³„μ  νΈν–¥ (Bar-mitzvah κ³µκ²©) |
| 3DES | 64-bit λΈ”λ΅ (Sweet32 κ³µκ²©) |
| MD5 | μ¶©λ κ³µκ²© κ°€λ¥ (Chosen-prefix collision) |
| SHA-1 | μ¶©λ κ³µκ²© κ°€λ¥ (SHAttered) |
| μ••μ¶• | CRIME, BREACH κ³µκ²© |
| μ¬ν‘μƒ | λ³µμ΅μ„±, κ³µκ²© ν‘λ©΄ μ¦κ°€ |
| μ»¤μ¤ν…€ DHE κ·Έλ£Ή | Logjam κ³µκ²©, ν‘μƒ λ³µμ΅μ„± |

**TLS 1.3 ν•„μ μ•κ³ λ¦¬μ¦**:

**ν‚¤ κµν™**:
- DHE: ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192
- ECDHE: secp256r1, secp384r1, secp521r1, x25519, x448
- λ¨λ‘ (EC)DHEλ΅ Forward Secrecy λ³΄μ¥

**λ€μΉ­ν‚¤ μ•”νΈ (AEADλ§)**:
- TLS_AES_128_GCM_SHA256 (ν•„μ)
- TLS_AES_256_GCM_SHA384
- TLS_CHACHA20_POLY1305_SHA256 (ν•„μ)
- TLS_AES_128_CCM_SHA256
- TLS_AES_128_CCM_8_SHA256

**λ””μ§€ν„Έ μ„λ…**:
- RSA-PSS (rsae, pss): rsa_pss_rsae_sha256, rsa_pss_pss_sha256 λ“±
- ECDSA: ecdsa_secp256r1_sha256, ecdsa_secp384r1_sha384 λ“±
- EdDSA: ed25519, ed448

**ν•΄μ‹ ν•¨μ**:
- SHA-256, SHA-384 (SHA-1 μ κ±°)
- HKDF (HMAC-based KDF)

**μ„±λ¥ κ°μ„ **:
```
ν•Έλ“μ…°μ΄ν¬:
- TLS 1.2: 2-RTT (Full handshake)
- TLS 1.3: 1-RTT (KeyShare in ClientHello)
- TLS 1.3: 0-RTT (PSK mode, replay μ£Όμ)

μ•”νΈν™”:
- TLS 1.2: Encrypt-then-MAC (μμ°¨)
- TLS 1.3: AEAD (λ³‘λ ¬ κ°€λ¥)

λ³µμ΅λ„:
- TLS 1.2: 37κ° cipher suites (TLS 1.2 RFC)
- TLS 1.3: 5κ° cipher suites
```

**κ¶μ¥ μ„¤μ •** (IETF/Mozilla κΈ°μ¤€):

**Modern (TLS 1.3 only)**:
```
ν‚¤ κµν™: x25519, secp256r1, secp384r1
μ•”νΈν™”: TLS_AES_128_GCM_SHA256, TLS_CHACHA20_POLY1305_SHA256
μΈμ¦μ„: ECDSA P-256, RSA 2048 μµμ†
```

**Intermediate (TLS 1.2 νΈν™)**:
```
TLS 1.3 + TLS 1.2 (ECDHE + AEADλ§)
- TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
- TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
- TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
- TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256

β οΈ κΈμ§€: RSA ν‚¤ κµν™, AES-CBC, 3DES, RC4
```

### Cipher Suite (μ•”νΈν™” μ¤μ„νΈ)

TLS μ—°κ²°μ— μ‚¬μ©λ  μ•”νΈν™” μ•κ³ λ¦¬μ¦μ μ΅°ν•©:

**TLS 1.2 ν•μ‹**:
```
TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
β”‚   β”‚     β”‚        β”‚       β”‚   β”‚
β”‚   β”‚     β”‚        β”‚       β”‚   β””β”€ ν•΄μ‹: SHA-256
β”‚   β”‚     β”‚        β”‚       β””β”€β”€β”€β”€β”€ μ•”νΈν™” λ¨λ“: GCM
β”‚   β”‚     β”‚        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ λ€μΉ­ν‚¤ μ•”νΈν™”: AES-128
β”‚   β”‚     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ μ„λ²„ μΈμ¦: RSA
β”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ ν‚¤ κµν™: ECDHE
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ ν”„λ΅ν† μ½: TLS
```

**TLS 1.3 ν•μ‹** (λ‹¨μν™”):
```
TLS_AES_128_GCM_SHA256
β”‚   β”‚       β”‚   β”‚
β”‚   β”‚       β”‚   β””β”€ ν•΄μ‹: SHA-256
β”‚   β”‚       β””β”€β”€β”€β”€β”€ μ•”νΈν™” λ¨λ“: GCM
β”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ λ€μΉ­ν‚¤ μ•”νΈν™”: AES-128
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ ν”„λ΅ν† μ½: TLS (ν‚¤ κµν™μ€ ECDHEλ΅ κ³ μ •)
```

### Forward Secrecy (μ „λ°©ν–¥ λΉ„λ°€μ„±)

- **κ°λ…**: μ„Έμ… ν‚¤κ°€ μ μ¶λμ–΄λ„ κ³Όκ±° ν†µμ‹  λ‚΄μ©μ€ λ³µνΈν™”ν•  μ μ—†μ
- **κµ¬ν„**: μ„μ‹(Ephemeral) ν‚¤ κµν™ λ°©μ‹ μ‚¬μ© (DHE, ECDHE)
- **μ¤‘μ”μ„±**: μ„λ²„μ κ°μΈν‚¤κ°€ νƒμ·¨λμ–΄λ„ μ΄μ „ μ„Έμ… λ°μ΄ν„° λ³΄νΈ
- **TLS 1.3**: λ¨λ“  μ—°κ²°μ—μ„ Forward Secrecy ν•„μ

### TLSμ λ³΄μ• μ·¨μ•½μ 

#### κ³Όκ±°μ μ£Όμ” κ³µκ²©
1. **BEAST** (2011): TLS 1.0μ CBC λ¨λ“ μ·¨μ•½μ 
2. **CRIME** (2012): TLS μ••μ¶• κΈ°λ¥ μ•…μ©
3. **Heartbleed** (2014): OpenSSL κµ¬ν„ λ²„κ·Έλ΅ λ©”λ¨λ¦¬ λ„μ¶
4. **POODLE** (2014): SSL 3.0μ ν¨λ”© μ¤λΌν΄ κ³µκ²©
5. **FREAK** (2015): Export-grade μ•”νΈν™” κ°•μ  λ‹¤μ΄κ·Έλ μ΄λ“
6. **Logjam** (2015): DHE ν‚¤ κµν™ μ•½μ 
7. **DROWN** (2016): SSLv2 μ·¨μ•½μ  μ•…μ©

#### λ€μ‘ λ°©λ²•
- **μµμ‹  TLS λ²„μ „ μ‚¬μ©**: TLS 1.2 μ΄μƒ (TLS 1.3 κ¶μ¥)
- **μ•½ν• μ•”νΈν™” λΉ„ν™μ„±ν™”**: RC4, 3DES, MD5, SHA-1 μ κ±°
- **HSTS (HTTP Strict Transport Security)**: HTTPS κ°•μ 
- **Certificate Pinning**: νΉμ • μΈμ¦μ„λ§ μ‹ λΆ°
- **μ •κΈ°μ μΈ λ³΄μ• ν¨μΉ**: OpenSSL, BoringSSL λ“± λΌμ΄λΈλ¬λ¦¬ μ—…λ°μ΄νΈ

### TLS μ μ© μμ‹

#### HTTPS (HTTP over TLS)
```
http://example.com   β†’ ν¬νΈ 80, μ•”νΈν™” μ—†μ
https://example.com  β†’ ν¬νΈ 443, TLS μ•”νΈν™”
```

#### κΈ°νƒ€ ν”„λ΅ν† μ½
- **FTPS**: FTP over TLS (ν¬νΈ 990 λλ” 21)
- **SMTPS**: SMTP over TLS (ν¬νΈ 465)
- **IMAPS**: IMAP over TLS (ν¬νΈ 993)
- **LDAPS**: LDAP over TLS (ν¬νΈ 636)
- **DoT**: DNS over TLS (ν¬νΈ 853)

### TLS μ„¤μ • ν™•μΈ

#### OpenSSL λ…λ Ήμ–΄
```bash
# μ„λ²„ TLS λ²„μ „ ν™•μΈ
openssl s_client -connect example.com:443 -tls1_3

# μΈμ¦μ„ ν™•μΈ
openssl s_client -connect example.com:443 -showcerts

# μ§€μ›ν•λ” Cipher Suite ν™•μΈ
nmap --script ssl-enum-ciphers -p 443 example.com

# μΈμ¦μ„ λ§λ£μΌ ν™•μΈ
echo | openssl s_client -connect example.com:443 2>/dev/null | openssl x509 -noout -dates
```

#### μ¨λΌμΈ ν…μ¤νΈ λ„κµ¬
- **SSL Labs**: https://www.ssllabs.com/ssltest/
  - A+ λ“±κΈ‰ λ©ν‘
  - TLS 1.2/1.3, κ°•λ ¥ν• μ•”νΈν™”, HSTS, Forward Secrecy ν•„μ
- **Qualys SSL Server Test**: μƒμ„Έν• TLS μ„¤μ • λ¶„μ„

### λ¨λ²” μ‚¬λ΅€ (Best Practices)

1. **TLS 1.3 μ°μ„ , TLS 1.2 μµμ†**
   - TLS 1.0, 1.1, SSL λ¨λ‘ λΉ„ν™μ„±ν™”

2. **κ°•λ ¥ν• Cipher Suite μ„ νƒ**
   ```
   μ°μ„ μμ„:
   1. TLS_AES_256_GCM_SHA384 (TLS 1.3)
   2. TLS_CHACHA20_POLY1305_SHA256 (TLS 1.3)
   3. TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (TLS 1.2)
   ```

3. **μΈμ¦μ„ κ΄€λ¦¬**
   - 2048-bit RSA λλ” 256-bit ECDSA μµμ†
   - μλ™ κ°±μ‹  μ„¤μ • (Let's Encrypt + Certbot)
   - μ™€μΌλ“μΉ΄λ“ μΈμ¦μ„ μ‹ μ¤‘ν•κ² μ‚¬μ©

4. **HSTS ν™μ„±ν™”**
   ```
   Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
   ```

5. **OCSP Stapling**
   - μΈμ¦μ„ νκΈ° μƒνƒλ¥Ό λΉ λ¥΄κ² ν™•μΈ
   - ν”„λΌμ΄λ²„μ‹ λ³΄νΈ (ν΄λΌμ΄μ–ΈνΈκ°€ CAμ— μ§μ ‘ λ¬Έμ μ• ν•¨)

6. **Session Resumption**
   - Session ID λλ” Session TicketμΌλ΅ μ¬μ—°κ²° μ†λ„ ν–¥μƒ
   - ν•μ§€λ§ Forward Secrecy κ³ λ ¤

## ν•µμ‹¬ ν‚¤μ›λ“ μ •λ¦¬

### 1. TLS (Transport Layer Security)
λ„¤νΈμ›ν¬ ν†µμ‹ μ—μ„ λ°μ΄ν„°μ κΈ°λ°€μ„±, λ¬΄κ²°μ„±, μΈμ¦μ„ λ³΄μ¥ν•λ” μ•”νΈν™” ν”„λ΅ν† μ½. SSLμ ν›„μ† ν‘μ¤€μΌλ΅ IETFκ°€ κ΄€λ¦¬ν•λ©°, ν„μ¬ TLS 1.3μ΄ μµμ‹  λ²„μ „.

### 2. ν•Έλ“μ…°μ΄ν¬ (Handshake)
ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ•”νΈν™” ν†µμ‹ μ„ μ‹μ‘ν•κΈ° μ „μ— μ•”νΈν™” λ°©μ‹, ν‚¤ κµν™, μΈμ¦μ„ κ²€μ¦ λ“±μ„ ν‘μƒν•λ” κ³Όμ •. TLS 1.3μ€ 1-RTTλ΅ TLS 1.2(2-RTT)λ³΄λ‹¤ λΉ λ¦„.

### 3. X.509 μΈμ¦μ„ (Certificate)
μ„λ²„μ μ‹ μ›μ„ μ¦λ…ν•λ” λ””μ§€ν„Έ λ¬Έμ„. κ³µκ°ν‚¤, λ„λ©”μΈ μ •λ³΄, λ°κΈ‰ κΈ°κ΄€(CA) μ„λ…μ„ ν¬ν•¨ν•λ©°, ν΄λΌμ΄μ–ΈνΈλ” μ΄λ¥Ό κ²€μ¦ν•μ—¬ μ„λ²„μ μ •λ‹Ήμ„± ν™•μΈ.

### 4. CA (Certificate Authority)
λ””μ§€ν„Έ μΈμ¦μ„λ¥Ό λ°κΈ‰ν•κ³  μ„λ…ν•λ” μ‹ λΆ°ν•  μ μλ” μ 3μ κΈ°κ΄€. DigiCert, Let's Encrypt λ“±μ΄ μμΌλ©°, λΈλΌμ°μ €λ” CAμ Root μΈμ¦μ„λ¥Ό μ‚¬μ „ μ„¤μΉν•μ—¬ μ‹ λΆ° μ²΄μΈ κµ¬μ¶•.

### 5. Cipher Suite
TLS μ—°κ²°μ— μ‚¬μ©λ  μ•”νΈν™” μ•κ³ λ¦¬μ¦μ μ΅°ν•©. ν‚¤ κµν™(ECDHE), μΈμ¦(RSA/ECDSA), λ€μΉ­ν‚¤ μ•”νΈν™”(AES-GCM), ν•΄μ‹(SHA-256) μ•κ³ λ¦¬μ¦μ„ μ§€μ •.

### 6. ECDHE (Elliptic Curve Diffie-Hellman Ephemeral)
νƒ€μ› κ³΅μ„  μ•”νΈν™” κΈ°λ°μ ν‚¤ κµν™ μ•κ³ λ¦¬μ¦. κ° μ„Έμ…λ§λ‹¤ μ„μ‹ ν‚¤λ¥Ό μƒμ„±ν•μ—¬ Forward Secrecyλ¥Ό μ κ³µν•λ©°, RSA ν‚¤ κµν™λ³΄λ‹¤ μ•μ „.

### 7. AES-GCM (Advanced Encryption Standard - Galois/Counter Mode)
λ€μΉ­ν‚¤ μ•”νΈν™” μ•κ³ λ¦¬μ¦μΌλ΅ TLSμ—μ„ κ°€μ¥ λ„λ¦¬ μ‚¬μ©λ¨. AEAD(μΈμ¦λ μ•”νΈν™”) λ°©μ‹μΌλ΅ μ•”νΈν™”μ™€ λ¬΄κ²°μ„± κ²€μ¦μ„ λ™μ‹μ— μν–‰.

### 8. Forward Secrecy (μ „λ°©ν–¥ λΉ„λ°€μ„±)
μ„Έμ… ν‚¤κ°€ μ μ¶λμ–΄λ„ κ³Όκ±° ν†µμ‹  λ‚΄μ©μ€ λ³µνΈν™”ν•  μ μ—†λ„λ΅ λ³΄μ¥ν•λ” λ³΄μ• μ†μ„±. ECDHE, DHE κ°™μ€ μ„μ‹ ν‚¤ κµν™ λ°©μ‹μΌλ΅ κµ¬ν„.

### 9. HSTS (HTTP Strict Transport Security)
μ›Ήμ‚¬μ΄νΈκ°€ λΈλΌμ°μ €μ—κ² HTTPSλ§ μ‚¬μ©ν•λ„λ΅ κ°•μ ν•λ” λ³΄μ• ν—¤λ”. HTTPλ΅ μ ‘κ·Ό μ‹λ„λ¥Ό μλ™μΌλ΅ HTTPSλ΅ λ¦¬λ‹¤μ΄λ ‰νΈν•μ—¬ μ¤‘κ°„μ κ³µκ²© λ°©μ§€.

### 10. OCSP Stapling
μ„λ²„κ°€ μΈμ¦μ„ νκΈ° μƒνƒ(OCSP μ‘λ‹µ)λ¥Ό λ―Έλ¦¬ κ°€μ Έμ™€ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬ν•λ” κΈ°λ²•. ν΄λΌμ΄μ–ΈνΈμ CA μ΅°νλ¥Ό μƒλµν•μ—¬ μ„±λ¥ ν–¥μƒ λ° ν”„λΌμ΄λ²„μ‹ λ³΄νΈ.

## ν•µμ‹¬ μ •λ¦¬
- **TLSλ” SSLμ ν›„μ† ν‘μ¤€**: SSLμ€ λ¨λ‘ μ·¨μ•½ν•μ—¬ μ‚¬μ© κΈμ§€, TLS 1.2 μ΄μƒ ν•„μ (TLS 1.3 κ¶μ¥)
- **3κ°€μ§€ λ³΄μ• λ©ν‘**: κΈ°λ°€μ„±(μ•”νΈν™”), λ¬΄κ²°μ„±(λ³€μ΅° λ°©μ§€), μΈμ¦(μ‹ μ› ν™•μΈ)
- **ν•Έλ“μ…°μ΄ν¬**: TLS 1.3μ€ 1-RTTλ΅ TLS 1.2λ³΄λ‹¤ 50% λΉ λ¦„, 0-RTT λ¨λ“λ„ μ§€μ›
- **μΈμ¦μ„ μ²΄μΈ**: Root CA β†’ Intermediate CA β†’ μ„λ²„ μΈμ¦μ„ μμΌλ΅ κ²€μ¦
- **Cipher Suite**: ν‚¤ κµν™(ECDHE) + μΈμ¦(RSA/ECDSA) + μ•”νΈν™”(AES-GCM) + ν•΄μ‹(SHA-256) μ΅°ν•©
- **Forward Secrecy**: ECDHE ν‚¤ κµν™μΌλ΅ κ³Όκ±° μ„Έμ… λ°μ΄ν„° λ³΄νΈ
- **λ³΄μ• μ„¤μ •**: TLS 1.3 μ‚¬μ©, κ°•λ ¥ν• Cipher Suite, HSTS, OCSP Stapling ν™μ„±ν™”

## μ°Έκ³  μλ£
- [RFC 8446 - The Transport Layer Security (TLS) Protocol Version 1.3](https://datatracker.ietf.org/doc/html/rfc8446)
- [RFC 5246 - The Transport Layer Security (TLS) Protocol Version 1.2](https://datatracker.ietf.org/doc/html/rfc5246)
- [Mozilla SSL Configuration Generator](https://ssl-config.mozilla.org/)
- [OWASP Transport Layer Protection Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html)
- [SSL Labs - Best Practices](https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices)
- [Cloudflare - What is SSL/TLS](https://www.cloudflare.com/learning/ssl/what-is-ssl/)
