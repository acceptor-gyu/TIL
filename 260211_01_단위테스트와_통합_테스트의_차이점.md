# 단위테스트와 통합 테스트의 차이점은 무엇인가요?

## 개요
단위 테스트(Unit Test)와 통합 테스트(Integration Test)의 개념, 차이점, 그리고 각각의 활용 방법에 대해 학습합니다.

## 상세 내용

### 단위 테스트 (Unit Test)
- **정의**: 애플리케이션의 가장 작은 단위(메서드, 함수, 클래스)를 독립적으로 테스트
- **특징**:
  - 외부 의존성(DB, API, 파일 시스템 등)을 Mock/Stub으로 대체
  - 빠른 실행 속도
  - 특정 로직의 정확성 검증
- **목적**: 개별 컴포넌트가 의도한 대로 동작하는지 확인

### 통합 테스트 (Integration Test)
- **정의**: 여러 컴포넌트나 모듈이 함께 동작할 때의 상호작용을 테스트
- **특징**:
  - 실제 외부 의존성을 사용하거나 테스트용 환경(Test Container, In-Memory DB 등) 활용
  - 단위 테스트보다 느린 실행 속도
  - 컴포넌트 간 인터페이스와 데이터 흐름 검증
- **목적**: 시스템의 여러 부분이 함께 올바르게 작동하는지 확인

### 슬라이스 테스트 (Slice Test)
- **정의**: 애플리케이션의 특정 계층(Layer)만 로드하여 테스트하는 방식
- **특징**:
  - 전체 애플리케이션 컨텍스트가 아닌 특정 부분만 로드하여 빠른 실행
  - 통합 테스트보다 가볍고, 단위 테스트보다 실제 환경에 가까움
  - Spring Boot가 제공하는 다양한 슬라이스 어노테이션 활용
- **목적**: 특정 계층의 기능을 격리하여 효율적으로 테스트

#### 주요 슬라이스 테스트 종류
- **@WebMvcTest**: MVC 컨트롤러 계층 테스트 (Controller, Filter, Interceptor 등만 로드)
- **@DataJpaTest**: JPA 레포지토리 계층 테스트 (JPA 관련 설정만 로드, 기본적으로 인메모리 DB 사용)
- **@RestClientTest**: REST 클라이언트 테스트
- **@JsonTest**: JSON 직렬화/역직렬화 테스트
- **@WebFluxTest**: WebFlux 컨트롤러 테스트

### 주요 차이점

| 구분 | 단위 테스트 | 슬라이스 테스트 | 통합 테스트 |
|------|------------|--------------|------------|
| 범위 | 단일 컴포넌트 | 특정 계층 | 여러 컴포넌트 |
| 의존성 | Mock/Stub 사용 | 계층별 필요한 의존성만 | 실제 또는 테스트용 의존성 |
| 실행 속도 | 매우 빠름 | 빠름 | 상대적으로 느림 |
| 컨텍스트 로드 | 없음 | 부분 로드 | 전체 로드 |
| 격리성 | 높음 | 중간 | 낮음 |
| 발견 오류 | 로직 오류 | 계층별 설정/통합 오류 | 전체 통합 오류 |

### 예시

**단위 테스트**:
```java
@Test
@DisplayName("계산기 덧셈 테스트")
void addTest() {
    Calculator calculator = new Calculator();
    int result = calculator.add(2, 3);
    assertEquals(5, result);
}
```

**슬라이스 테스트**:
```java
@WebMvcTest(UserController.class)
class UserControllerSliceTest {
    @Autowired
    private MockMvc mockMvc;

    @MockBean
    private UserService userService;

    @Test
    @DisplayName("사용자 조회 컨트롤러 테스트")
    void getUserTest() throws Exception {
        // Given
        User user = new User(1L, "홍길동");
        when(userService.getUser(1L)).thenReturn(user);

        // When & Then
        mockMvc.perform(get("/users/1"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.name").value("홍길동"));
    }
}
```

**통합 테스트**:
```java
@SpringBootTest
@AutoConfigureMockMvc
class UserServiceIntegrationTest {
    @Autowired
    private MockMvc mockMvc;

    @Test
    @DisplayName("사용자 생성 및 조회 통합 테스트")
    void createAndGetUserTest() throws Exception {
        // POST로 사용자 생성
        mockMvc.perform(post("/users")
                .contentType(MediaType.APPLICATION_JSON)
                .content("{\"name\":\"홍길동\"}"))
                .andExpect(status().isCreated());

        // GET으로 생성된 사용자 조회
        mockMvc.perform(get("/users/1"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.name").value("홍길동"));
    }
}
```

## 테스트 코드를 작성해야 하는 이유

### 1. 버그 조기 발견
- 개발 단계에서 오류를 빠르게 발견하고 수정
- 프로덕션 배포 전 문제 해결로 비용 절감
- 회귀 버그(Regression Bug) 방지

### 2. 리팩토링 안정성
- 코드 변경 시 기존 기능이 정상 동작하는지 즉시 확인
- 자신감 있는 코드 개선 가능
- 레거시 코드 개선 시 안전망 역할

### 3. 문서화 효과
- 테스트 코드 자체가 살아있는 문서 역할
- 코드 사용법과 의도를 명확하게 표현
- 새로운 개발자의 온보딩 시간 단축

### 4. 개발 생산성 향상
- 수동 테스트 시간 절약
- 빠른 피드백 루프로 개발 속도 향상
- CI/CD 파이프라인과 통합하여 자동화

### 5. 코드 품질 향상
- 테스트하기 쉬운 코드는 좋은 설계를 유도 (낮은 결합도, 높은 응집도)
- 엣지 케이스와 예외 상황 고려하게 됨
- 명확한 인터페이스와 책임 분리

### 6. 협업 효율성
- 다른 팀원의 코드 변경이 내 코드에 미치는 영향 즉시 파악
- 코드 리뷰 시 테스트로 의도 명확히 전달
- 통합 시 발생할 수 있는 문제 사전 방지

### 테스트 피라미드
```
        /  \
       /E2E \        적음 (느림, 비용 높음)
      /------\
     /통합 테스트\      중간
    /----------\
   / 슬라이스 테스트\    많음
  /--------------\
 /    단위 테스트    \   매우 많음 (빠름, 비용 낮음)
/------------------\
```

- **단위 테스트**: 많이 작성 (빠르고 저렴)
- **슬라이스 테스트**: 적절히 작성 (계층별 검증)
- **통합 테스트**: 중요한 시나리오 중심으로 작성
- **E2E 테스트**: 핵심 사용자 시나리오만 작성 (느리고 비용 높음)

## 핵심 정리
- 단위 테스트는 **개별 컴포넌트의 로직**을 빠르게 검증
- 슬라이스 테스트는 **특정 계층**을 부분적으로 로드하여 효율적으로 검증
- 통합 테스트는 **컴포넌트 간 상호작용**을 검증
- 테스트 피라미드에 따라 단위 테스트를 많이, 슬라이스/통합 테스트를 적절히 작성
- 테스트 코드는 버그 방지, 리팩토링 안정성, 문서화, 코드 품질 향상에 기여
- 적절한 테스트 전략은 장기적으로 개발 생산성과 제품 품질을 높임

## 참고 자료
- [Spring Framework Testing Documentation](https://docs.spring.io/spring-framework/reference/testing.html)
- [JUnit 5 User Guide](https://junit.org/junit5/docs/current/user-guide/)
- [Test Pyramid - Martin Fowler](https://martinfowler.com/articles/practical-test-pyramid.html)
